<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building a Homelab with Docker Swarm - seqx</title>
    <link rel="stylesheet" href="../css/weblog-style.css">
</head>
<body>
    <pre class="ascii-title">
░██████╗███████╗░██████╗░██╗░░██╗
██╔════╝██╔════╝██╔═══██╗╚██╗██╔╝
╚█████╗░█████╗░░██║██╗██║░╚███╔╝░
░╚═══██╗██╔══╝░░╚██████╔╝░██╔██╗░
██████╔╝███████╗░╚═██╔═╝░██╔╝╚██╗
╚═════╝░╚══════╝░░░╚═╝░░░╚═╝░░╚═╝
</pre>
    
    <div class="nav">
        <a href="../index.html">index</a>
        <a href="../about.html">about</a>
    </div>

    <div class="post-header">
        <div class="post-title">Building a Homelab with Docker Swarm</div>
        <div class="post-date">2025.09.27</div>
    </div>

    <div class="post-content">
        <h1>Building a Homelab with Docker Swarm</h1>
<p>Setting up a homelab is one of the best ways to learn infrastructure management. In this guide, I'll walk you through building a <strong>production-ready</strong> homelab using <em>Docker Swarm</em> for orchestration.</p>
<h2>Why Docker Swarm?</h2>
<p>While Kubernetes gets all the attention, Docker Swarm offers several advantages for homelab environments:</p>
<ul>
<li>Simple setup and configuration</li>
<li>Built-in load balancing</li>
<li>Native Docker integration</li>
<li>Lower resource overhead than K8s</li>
<li>Perfect for learning container orchestration concepts</li>
</ul>
<blockquote>
<p>"The best homelab is the one you actually use and maintain. Start simple, then add complexity as you learn."</p>
</blockquote>
<h2>Hardware Requirements</h2>
<p>For this setup, you'll need at least 3 nodes for high availability. Here's my recommended configuration:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Minimum</th>
<th>Recommended</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>2 cores</td>
<td>4+ cores</td>
<td>x86_64 architecture</td>
</tr>
<tr>
<td>RAM</td>
<td>4GB</td>
<td>8GB+</td>
<td>More is better for containers</td>
</tr>
<tr>
<td>Storage</td>
<td>32GB</td>
<td>128GB+ SSD</td>
<td>Fast I/O is crucial</td>
</tr>
<tr>
<td>Network</td>
<td>100Mbps</td>
<td>1Gbps</td>
<td>Low latency preferred</td>
</tr>
</tbody>
</table>
<h3>Node Setup Process</h3>
<p>First, install Docker on all nodes. On Ubuntu/Debian systems:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Update package index</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update

<span class="c1"># Install Docker</span>
curl<span class="w"> </span>-fsSL<span class="w"> </span>https://get.docker.com<span class="w"> </span>-o<span class="w"> </span>get-docker.sh
sudo<span class="w"> </span>sh<span class="w"> </span>get-docker.sh

<span class="c1"># Add user to docker group</span>
sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>

<span class="c1"># Enable Docker service</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>docker
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>docker
</code></pre></div>

<h3>Initialize the Swarm</h3>
<p>On your manager node (choose the most reliable machine), initialize the swarm:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Initialize swarm on manager node</span>
docker<span class="w"> </span>swarm<span class="w"> </span>init<span class="w"> </span>--advertise-addr<span class="w"> </span>&lt;MANAGER-IP&gt;

<span class="c1"># The output will show join commands like:</span>
<span class="c1"># docker swarm join --token SWMTKN-1-... &lt;MANAGER-IP&gt;:2377</span>
</code></pre></div>

<h4>Adding Worker Nodes</h4>
<p>Run the join command from the previous step on each worker node:</p>
<div class="codehilite"><pre><span></span><code>docker<span class="w"> </span>swarm<span class="w"> </span>join<span class="w"> </span>--token<span class="w"> </span>SWMTKN-1-...<span class="w"> </span>&lt;MANAGER-IP&gt;:2377
</code></pre></div>

<h2>Essential Services</h2>
<p>Here are the core services I recommend for any homelab:</p>
<h3>1. Monitoring Stack</h3>
<ol>
<li><strong>Prometheus</strong> - Metrics collection</li>
<li><strong>Grafana</strong> - Visualization dashboard</li>
<li><strong>Node Exporter</strong> - System metrics</li>
<li><strong>cAdvisor</strong> - Container metrics</li>
</ol>
<h3>2. Logging</h3>
<ul>
<li>ELK Stack (Elasticsearch, Logstash, Kibana)</li>
<li>Or simpler alternatives:</li>
<li>Loki + Grafana</li>
<li>Fluentd + InfluxDB</li>
</ul>
<h3>3. Reverse Proxy</h3>
<p>I use <a href="https://traefik.io/">Traefik</a> for automatic service discovery and SSL termination:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">traefik</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik:v2.9</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--api.dashboard=true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--providers.docker.swarmMode=true</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--providers.docker.exposedbydefault=false</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:443&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8080:8080&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">node.role == manager</span><span class="p p-Indicator">]</span>
</code></pre></div>

<hr />
<h2>Security Considerations</h2>
<h5>Network Segmentation</h5>
<p>Always isolate your homelab network from your main network. Use VLANs or separate physical networks.</p>
<h6>Key Security Practices</h6>
<dl>
<dt><strong>Firewall Rules</strong></dt>
<dd>Only expose necessary ports. Use UFW or iptables to restrict access.</dd>
<dt><strong>Regular Updates</strong></dt>
<dd>Keep your base OS and Docker images updated. Automate where possible.</dd>
<dt><strong>Secrets Management</strong></dt>
<dd>Use Docker secrets for sensitive data, never hardcode passwords.</dd>
<dt><strong>Backup Strategy</strong></dt>
<dd>Implement automated backups for both data and configurations.</dd>
</dl>
<h2>Useful Commands</h2>
<p>Here's a quick reference of Docker Swarm commands you'll use frequently:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># View swarm nodes</span>
docker<span class="w"> </span>node<span class="w"> </span>ls

<span class="c1"># Deploy a stack</span>
docker<span class="w"> </span>stack<span class="w"> </span>deploy<span class="w"> </span>-c<span class="w"> </span>docker-compose.yml<span class="w"> </span>myapp

<span class="c1"># List running services</span>
docker<span class="w"> </span>service<span class="w"> </span>ls

<span class="c1"># Scale a service</span>
docker<span class="w"> </span>service<span class="w"> </span>scale<span class="w"> </span><span class="nv">myapp_web</span><span class="o">=</span><span class="m">3</span>

<span class="c1"># View service logs</span>
docker<span class="w"> </span>service<span class="w"> </span>logs<span class="w"> </span>myapp_web

<span class="c1"># Remove a stack</span>
docker<span class="w"> </span>stack<span class="w"> </span>rm<span class="w"> </span>myapp
</code></pre></div>

<h2>Next Steps</h2>
<p>Once you have your basic swarm running, consider these additions:</p>
<ol>
<li>Set up automated backups with <code>restic</code> or <code>borg</code></li>
<li>Implement centralized logging</li>
<li>Add monitoring and alerting</li>
<li>Experiment with CI/CD pipelines</li>
<li>Try different storage solutions (GlusterFS, Ceph)</li>
</ol>
<p><img alt="Homelab Architecture Diagram" src="https://via.placeholder.com/500x300/333333/9d4edd?text=Homelab+Architecture" />
<em>Example homelab architecture with Docker Swarm</em></p>
<h2>Conclusion</h2>
<p>Building a homelab with Docker Swarm is an excellent way to learn container orchestration without the complexity of Kubernetes. Start small, document everything, and gradually add more services as you become comfortable with the platform.</p>
<p>Remember: the goal isn't to replicate production environments exactly, but to create a learning platform where you can safely experiment and break things.</p>
<p><em>Happy homelabbing!</em></p>
    </div>

    <div class="back-link">
        <a href="../index.html">← back to index</a>
    </div>
</body>
</html>
